CREATE database clique_bait;

CREATE TABLE clique_bait.dbo.event_identifier (
  "event_type" INTEGER,
  "event_name" VARCHAR(13)
);

INSERT INTO clique_bait.dbo.event_identifier
  ("event_type", "event_name")
VALUES
  ('1', 'Page View'),
  ('2', 'Add to Cart'),
  ('3', 'Purchase'),
  ('4', 'Ad Impression'),
  ('5', 'Ad Click');
CREATE TABLE clique_bait.dbo.campaign_identifier (
  "campaign_id" INTEGER,
  "products" VARCHAR(3),
  "campaign_name" VARCHAR(33),
  "start_date" date,
  "end_date" date
);

INSERT INTO clique_bait.dbo.campaign_identifier
  ("campaign_id", "products", "campaign_name", "start_date", "end_date")
VALUES
  ('1', '1-3', 'BOGOF - Fishing For Compliments', '2020-01-01', '2020-01-14'),
  ('2', '4-5', '25% Off - Living The Lux Life', '2020-01-15', '2020-01-28'),
  ('3', '6-8', 'Half Off - Treat Your Shellf(ish)', '2020-02-01', '2020-03-31');

CREATE TABLE clique_bait.dbo.page_hierarchy (
  "page_id" INTEGER,
  "page_name" VARCHAR(14),
  "product_category" VARCHAR(9),
  "product_id" INTEGER
);

INSERT INTO clique_bait.dbo.page_hierarchy
  ("page_id", "page_name", "product_category", "product_id")
VALUES
  ('1', 'Home Page', null, null),
  ('2', 'All Products', null, null),
  ('3', 'Salmon', 'Fish', '1'),
  ('4', 'Kingfish', 'Fish', '2'),
  ('5', 'Tuna', 'Fish', '3'),
  ('6', 'Russian Caviar', 'Luxury', '4'),
  ('7', 'Black Truffle', 'Luxury', '5'),
  ('8', 'Abalone', 'Shellfish', '6'),
  ('9', 'Lobster', 'Shellfish', '7'),
  ('10', 'Crab', 'Shellfish', '8'),
  ('11', 'Oyster', 'Shellfish', '9'),
  ('12', 'Checkout', null, null),
  ('13', 'Confirmation', null, null);

CREATE TABLE clique_bait.dbo.users (
  "user_id" INTEGER,
  "cookie_id" VARCHAR(6),
  "start_date" date
);

INSERT INTO clique_bait.dbo.users
  ("user_id", "cookie_id", "start_date")
VALUES
  ('5', '25cf57', '2020-02-11'),
  ('171', '4753d4', '2020-01-26'),
  ('456', '12bf9d', '2020-02-10'),
  ('397', 'adc53a', '2020-03-14'),
  ('347', '8438e3', '2020-01-27'),
  ('297', '1e7467', '2020-02-13'),
  ('303', '529f02', '2020-01-27'),
  ('105', '9cd08f', '2020-02-23'),
  ('402', '5ecca8', '2020-02-24'),
  ('472', 'e4d9f4', '2020-02-28'),
  ('445', 'cd7cfd', '2020-02-28'),
  ('252', '1d1488', '2020-02-02'),
  ('31', '35c4ed', '2020-02-21'),
  ('327', '1edc73', '2020-03-01'),
  ('253', '7cd97b', '2020-02-18'),
  ('14', '92ee89', '2020-02-09'),
  ('497', 'b355b4', '2020-02-27'),
  ('195', '66f866', '2020-01-06'),
  ('199', '62e9b2', '2020-02-18'),
  ('441', '2a7bf3', '2020-03-25'),
  ('339', 'cdfa92', '2020-02-29'),
  ('243', 'f2aa1f', '2020-02-27'),
  ('383', '6bec8d', '2020-02-16'),
  ('7', 'f3f25d', '2020-03-18'),
  ('254', '0b7c24', '2020-03-16'),
  ('377', '3551ae', '2020-02-26'),
  ('78', 'c90ea9', '2020-01-23'),
  ('159', '2d0973', '2020-01-31'),
  ('20', '0d8eb5', '2020-03-07'),
  ('1', 'ac1c29', '2020-03-15'),
  ('106', 'c20a23', '2020-03-18'),
  ('178', '76f029', '2020-03-03'),
  ('68', '9b6ef5', '2020-01-19'),
  ('448', '13c322', '2020-02-27'),
  ('80', 'f1ef0b', '2020-02-08'),
  ('396', '2c4013', '2020-03-01'),
  ('389', 'a96443', '2020-01-06'),
  ('237', '092d3d', '2020-03-18'),
  ('451', '6cc48e', '2020-02-06'),
  ('348', '5da2e9', '2020-03-17'),
  ('337', 'dc3d86', '2020-02-06'),
  ('114', 'faabc8', '2020-03-03'),
  ('98', '024e6e', '2020-02-11'),
  ('82', 'b2a32c', '2020-02-06'),
  ('119', '0feb5d', '2020-03-02'),
  ('376', '78f9b3', '2020-02-16'),
  ('147', '067a26', '2020-03-04'),
  ('338', '98979a', '2020-01-19'),
  ('202', '3c7567', '2020-03-05'),
  ('358', 'fd5a4a', '2020-03-09'),
  ('79', '2b5d0f', '2020-02-22'),
  ('72', '7f0355', '2020-02-06'),
  ('77', '5edbd6', '2020-02-20'),
  ('131', 'eee875', '2020-02-15'),
  ('198', '301395', '2020-01-18'),
  ('17', 'b580b2', '2020-03-20'),
  ('310', '17497a', '2020-03-01'),
  ('353', 'e52fd7', '2020-03-02'),
  ('489', '8db5ce', '2020-02-02'),
  ('225', '73b2af', '2020-03-03'),
  ('395', '93ad45', '2020-02-28'),
  ('45', 'fe7770', '2020-02-15'),
  ('295', '2447bb', '2020-03-31'),
  ('134', '53c9e0', '2020-03-08'),
  ('274', '75adb2', '2020-02-17'),
  ('352', 'dcb6c8', '2020-01-13'),
  ('36', '5918b4', '2020-03-04'),
  ('362', '6de4b6', '2020-02-11'),
  ('221', '9061c1', '2020-03-12'),
  ('430', '1404fc', '2020-02-17'),
  ('102', '1f778d', '2020-02-15'),
  ('460', 'a4a9fd', '2020-02-18'),
  ('111', '424281', '2020-03-11'),
  ('459', 'bdc704', '2020-02-08'),
  ('207', 'fbc378', '2020-02-10'),
  ('62', '8480e0', '2020-02-07'),
  ('123', '07dc8c', '2020-03-04'),
  ('365', '7ec919', '2020-01-21'),
  ('157', 'a278e0', '2020-03-07'),
  ('308', 'aeb302', '2020-02-05'),
  ('313', '96aead', '2020-03-15'),
  ('150', 'eca8ba', '2020-03-03'),
  ('248', 'de0169', '2020-02-04'),
  ('429', '0bb40c', '2020-01-28'),
  ('25', '9478e3', '2020-03-01'),
  ('218', '858347', '2020-01-27'),
  ('434', '49cb32', '2020-02-18'),
  ('49', 'ed7099', '2020-02-08'),
  ('211', '28e7cd', '2020-01-26'),
  ('449', 'ac418c', '2020-01-18'),
  ('64', '2c8c4a', '2020-02-06'),
  ('55', '69885d', '2020-02-23'),
  ('184', '2a6e53', '2020-02-19'),
  ('477', '995168', '2020-04-08'),
  ('273', '3c4d72', '2020-01-28'),
  ('394', '130c99', '2020-01-29'),
  ('272', '9373f5', '2020-01-27'),
  ('190', '7b65d9', '2020-01-29'),
  ('278', '814bee', '2020-02-25'),
  ('406', '1fa9dc', '2020-02-10'),
  ('22', '57ae47', '2020-03-19'),
  ('156', '1b7f3c', '2020-02-24'),
  ('417', 'ec9ed1', '2020-03-11'),
  ('282', 'e15cde', '2020-03-20'),
  ('390', '467446', '2020-03-23'),
  ('173', '32b30d', '2020-01-25'),
  ('261', '822069', '2020-04-03'),
  ('42', '56d55b', '2020-04-07'),
  ('189', '6008f3', '2020-03-10'),
  ('257', '114144', '2020-03-18'),
  ('125', '1194cc', '2020-02-02'),
  ('113', '728449', '2020-05-03'),
  ('440', '8f4a6d', '2020-04-08'),
  ('187', 'a96445', '2020-01-26'),
  ('57', '4330a5', '2020-01-27'),
  ('19', '31ed15', '2020-03-09'),
  ('160', 'e56007', '2020-02-19'),
  ('331', '384ea6', '2020-02-24'),
  ('307', '4dda01', '2020-04-08'),
  ('91', '6ec64a', '2020-02-04'),
  ('54', '2f3541', '2020-03-02'),
  ('29', 'd0ab67', '2020-02-09'),
  ('96', '8f1274', '2020-02-22'),
  ('466', '25c0ae', '2020-04-09'),
  ('10', '7dbef1', '2020-01-24'),
  ('107', 'a6aa7d', '2020-03-05'),
  ('86', 'eddbd6', '2020-02-25'),
  ('219', '236a79', '2020-02-26'),
  ('175', 'f7d953', '2020-03-30'),
  ('231', '4ecb83', '2020-03-02'),
  ('66', '7d03cf', '2020-03-10'),
  ('340', 'e974ed', '2020-03-10'),
  ('13', 'c39c27', '2020-02-29'),
  ('2', 'd518ea', '2020-02-01'),
  ('368', 'c62e72', '2020-02-20'),
  ('246', 'ade5b6', '2020-03-03'),
  ('166', '78ce0d', '2020-04-28'),
  ('344', 'a3dced', '2020-03-15'),
  ('410', '4e36aa', '2020-04-05'),
  ('152', '41004f', '2020-04-10'),
  ('381', 'ffdd7e', '2020-02-28'),
  ('359', '91c1e4', '2020-04-01'),
  ('217', 'f06f29', '2020-02-17'),
  ('186', 'f57804', '2020-04-28'),
  ('182', 'caf192', '2020-01-24'),
  ('145', 'cbcee5', '2020-03-01'),
  ('27', '51f73c', '2020-02-27'),
  ('143', '8348c8', '2020-02-09'),
  ('228', 'a4556b', '2020-02-23'),
  ('485', '40d12c', '2020-03-10'),
  ('304', '794dee', '2020-02-12'),
  ('52', '48c70d', '2020-02-26'),
  ('438', '888aa1', '2020-02-09'),
  ('378', '9540ee', '2020-02-08'),
  ('84', 'bf0b5d', '2020-04-04'),
  ('170', 'd7acda', '2020-03-30'),
  ('192', '43d4f4', '2020-03-16'),
  ('276', '42f483', '2020-04-04'),
  ('101', 'aab89e', '2020-04-16'),
  ('473', 'f7f0f8', '2020-03-09'),
  ('320', '6f4b9e', '2020-03-23'),
  ('115', '57d867', '2020-03-12'),
  ('415', 'f6325a', '2020-02-21'),
  ('97', '50234d', '2020-02-10'),
  ('108', '742286', '2020-02-13'),
  ('408', '770e1c', '2020-03-14'),
  ('329', 'b2969b', '2020-03-07'),
  ('44', '7bae4d', '2020-02-09'),
  ('11', '220095', '2020-02-18'),
  ('401', 'a37cbf', '2020-01-14'),
  ('279', '6d5f7c', '2020-04-12'),
  ('9', 'ab7746', '2020-03-01'),
  ('419', 'e16ce1', '2020-03-29'),
  ('85', '296d07', '2020-02-20'),
  ('95', 'afad54', '2020-02-15'),
  ('302', '341488', '2020-02-13'),
  ('172', '3d2d54', '2020-02-27'),
  ('409', '23f3f8', '2020-04-06'),
  ('30', '6d240b', '2020-02-09'),
  ('3', 'a666ef', '2020-04-08'),
  ('388', '36be44', '2020-02-21'),
  ('165', '335c55', '2020-03-16'),
  ('56', '16e081', '2020-04-13'),
  ('138', '11bfeb', '2020-01-28'),
  ('34', 'fc630a', '2020-04-13'),
  ('418', '3cc483', '2020-01-29'),
  ('205', '12715b', '2020-01-09'),
  ('67', 'a7af4a', '2020-03-18'),
  ('325', 'bf54d8', '2020-02-05'),
  ('90', 'dce764', '2020-02-28'),
  ('443', '6bd6ba', '2020-03-03'),
  ('387', 'e5cc5f', '2020-02-10'),
  ('484', 'ec8b4e', '2020-02-19'),
  ('39', 'a9e0c3', '2020-02-02'),
  ('471', '370b14', '2020-02-23'),
  ('393', '1b6d74', '2020-04-21'),
  ('287', 'd4cd40', '2020-02-06'),
  ('312', '135ac5', '2020-01-19'),
  ('498', '13d2c9', '2020-01-24'),
  ('277', '8e317e', '2020-02-03'),
  ('494', 'b34a08', '2020-03-13'),
  ('300', '474d39', '2020-03-30'),
  ('284', 'a2ee85', '2020-03-29'),
  ('126', '8be687', '2020-01-18'),
  ('194', '01e0a8', '2020-03-15'),
  ('360', 'ca5acb', '2020-03-22'),
  ('463', '5cf21f', '2020-02-10'),
  ('99', '23ecdb', '2020-03-31'),
  ('41', 'b60112', '2020-02-24'),
  ('439', '64e2c8', '2020-03-31'),
  ('206', 'a5162a', '2020-01-07'),
  ('224', '38eaa0', '2020-02-09'),
  ('318', '99c849', '2020-03-05'),
  ('247', '2ebe6a', '2020-03-04'),
  ('136', '12359b', '2020-01-19'),
  ('442', 'ce3a75', '2020-01-28'),
  ('354', 'f9ec4a', '2020-04-15'),
  ('139', '1a9a2a', '2020-03-14'),
  ('12', '9c38c8', '2020-03-31'),
  ('293', '235b61', '2020-01-10'),
  ('495', '0774fb', '2020-02-13'),
  ('154', '8bde00', '2020-03-06'),
  ('234', '501406', '2020-04-12'),
  ('474', '16920d', '2020-03-02'),
  ('33', '7b0525', '2020-03-13'),
  ('422', '8bba89', '2020-03-15'),
  ('380', '74f56f', '2020-02-16'),
  ('215', '863329', '2020-01-26'),
  ('384', 'ae2a28', '2020-01-30'),
  ('116', '2113aa', '2020-03-05'),
  ('386', '595fd2', '2020-02-28'),
  ('431', 'cdecf8', '2020-01-26'),
  ('426', 'cf70f0', '2020-02-23'),
  ('364', 'a7dc45', '2020-01-06'),
  ('169', 'c796bd', '2020-02-10'),
  ('436', '2986f6', '2020-01-28'),
  ('180', '322fd1', '2020-02-28'),
  ('236', '3f0641', '2020-03-21'),
  ('197', '16fcc5', '2020-02-16'),
  ('135', 'dbe2d6', '2020-02-24'),
  ('493', '9394d9', '2020-02-28'),
  ('454', '8ea6b2', '2020-02-20'),
  ('149', 'f31bfd', '2020-03-14'),
  ('311', '957b3a', '2020-03-13'),
  ('88', 'cca605', '2020-02-06'),
  ('420', '1d97a9', '2020-02-23'),
  ('188', '2e33e0', '2020-03-20'),
  ('240', '7c3d5f', '2020-02-18'),
  ('196', 'c021a4', '2020-04-06'),
  ('226', '4978b8', '2020-02-12'),
  ('210', 'ed7347', '2020-04-11'),
  ('48', '9f0ac7', '2020-03-11'),
  ('81', '611d42', '2020-04-04'),
  ('244', '48c2af', '2020-03-04'),
  ('468', 'fde9a4', '2020-03-13'),
  ('251', 'd5dc8b', '2020-02-28'),
  ('204', '76bb9c', '2020-02-17'),
  ('5', '6e3db3', '2020-02-26'),
  ('427', '2e3090', '2020-03-07'),
  ('179', 'd7a98e', '2020-03-15'),
  ('297', '044162', '2020-03-12'),
  ('361', 'f9d4e3', '2020-02-11'),
  ('105', '326508', '2020-03-01'),
  ('472', '28060c', '2020-03-25'),
  ('444', '433d04', '2020-02-05'),
  ('233', '0b87cb', '2020-01-24'),
  ('343', '5eb280', '2020-03-08'),
  ('31', '67c175', '2020-03-13'),
  ('467', '0ce3b0', '2020-03-04'),
  ('253', '5b68b6', '2020-03-14'),
  ('14', '56ed52', '2020-02-25'),
  ('497', '5bcb93', '2020-03-06'),
  ('109', 'c5dd1d', '2020-02-16'),
  ('155', '86b02d', '2020-02-01'),
  ('133', '6046eb', '2020-02-06'),
  ('199', '42d377', '2020-03-03'),
  ('369', 'cdec43', '2020-03-15'),
  ('441', '543a2f', '2020-04-19'),
  ('339', 'e389ce', '2020-03-13'),
  ('243', 'ef7e71', '2020-03-13'),
  ('383', 'a74f6f', '2020-03-02'),
  ('254', '338349', '2020-03-24'),
  ('377', '91f222', '2020-03-02'),
  ('78', 'ee12cf', '2020-01-29'),
  ('159', '84d725', '2020-01-31'),
  ('250', 'e556f6', '2020-03-02'),
  ('319', '1b7be6', '2020-02-21'),
  ('129', '03bdcb', '2020-02-21'),
  ('8', 'e8086a', '2020-03-24'),
  ('455', '218077', '2020-02-07'),
  ('267', '65fe83', '2020-02-29'),
  ('68', 'a9d3f0', '2020-02-13'),
  ('448', 'cc50ed', '2020-03-10'),
  ('80', '72fc3d', '2020-03-01'),
  ('396', 'c6e79b', '2020-03-30'),
  ('162', '0e9f84', '2020-02-21'),
  ('322', '700fe9', '2020-04-10'),
  ('323', '71ee47', '2020-02-03'),
  ('337', '1c8905', '2020-03-03'),
  ('60', 'd8fe2e', '2020-02-07'),
  ('289', '6ed910', '2020-01-20'),
  ('124', '593a35', '2020-01-06'),
  ('98', '06cc3f', '2020-02-16'),
  ('200', '2fba33', '2020-01-26'),
  ('412', 'dbdd1d', '2020-03-04'),
  ('79', '3bb75e', '2020-03-08'),
  ('232', '5ea2a4', '2020-02-10'),
  ('77', '2f98e5', '2020-03-18'),
  ('37', '022f5f', '2020-03-22'),
  ('353', '689ed8', '2020-03-16'),
  ('225', '7f2acc', '2020-03-14'),
  ('63', '7c1a63', '2020-02-21'),
  ('395', '04df4c', '2020-03-05'),
  ('216', 'd0acc5', '2020-02-29'),
  ('45', '6b0d06', '2020-03-15'),
  ('274', 'ee8f59', '2020-02-21'),
  ('223', 'eae65a', '2020-03-21'),
  ('221', 'a31478', '2020-03-31'),
  ('102', '106769', '2020-02-27'),
  ('460', 'f57764', '2020-03-09'),
  ('265', 'b5e3d2', '2020-03-25'),
  ('459', '57d02a', '2020-03-02'),
  ('16', '349d38', '2020-01-20'),
  ('207', 'aa814a', '2020-02-16'),
  ('62', '359c9d', '2020-02-11'),
  ('123', '0cd75e', '2020-03-06'),
  ('326', '44fbee', '2020-02-09'),
  ('371', '9771f7', '2020-02-20'),
  ('157', '6db5d7', '2020-03-22'),
  ('183', '957adc', '2020-02-25'),
  ('100', '46183a', '2020-02-03'),
  ('150', 'fea51b', '2020-03-25'),
  ('140', '33bcb0', '2020-02-21'),
  ('248', '5fa6e2', '2020-02-12'),
  ('137', 'db423e', '2020-02-28'),
  ('208', 'b58db0', '2020-02-21'),
  ('392', '6ae143', '2020-02-02'),
  ('25', '0a0306', '2020-03-27'),
  ('141', 'a636a4', '2020-02-27'),
  ('94', 'd65932', '2020-02-24'),
  ('218', '3e9d84', '2020-02-02'),
  ('434', '97b83a', '2020-02-20'),
  ('465', '34cfdf', '2020-01-26'),
  ('64', '3ea186', '2020-02-23'),
  ('55', 'a8e347', '2020-02-27'),
  ('148', '967c5f', '2020-02-18'),
  ('394', '7c63c2', '2020-01-30'),
  ('70', 'b7019a', '2020-01-21'),
  ('190', '88673a', '2020-02-08'),
  ('350', 'be83ce', '2020-03-13'),
  ('406', '3e84f6', '2020-02-23'),
  ('176', '7ca184', '2020-01-10'),
  ('292', '925864', '2020-03-13'),
  ('475', '9d3949', '2020-02-09'),
  ('269', 'f9fdc4', '2020-02-26'),
  ('261', '1b5296', '2020-04-29'),
  ('189', '1dce93', '2020-03-25'),
  ('257', 'ce318a', '2020-03-19'),
  ('125', '83fffe', '2020-02-25'),
  ('40', '831039', '2020-02-13'),
  ('43', 'd643d2', '2020-03-18'),
  ('120', '58abb7', '2020-03-11'),
  ('440', '7ba91a', '2020-04-11'),
  ('187', '0e7a8c', '2020-02-02'),
  ('357', '1cd3ca', '2020-03-25'),
  ('242', '4a10ad', '2020-02-28'),
  ('366', '8d0ac0', '2020-01-22'),
  ('54', '45f8bf', '2020-03-10'),
  ('29', '45d4f7', '2020-02-16'),
  ('4', '63ce39', '2020-03-19'),
  ('466', '545a35', '2020-04-12'),
  ('10', '36dbe2', '2020-01-27'),
  ('35', 'a8a7ad', '2020-03-04'),
  ('446', '86dcf2', '2020-02-11'),
  ('220', '4a978a', '2020-02-22'),
  ('86', 'd8eb77', '2020-03-25'),
  ('219', '64759a', '2020-03-10'),
  ('241', 'a5dabc', '2020-04-11'),
  ('175', '0ef281', '2020-04-12'),
  ('285', '795b32', '2020-02-11'),
  ('231', 'a76482', '2020-03-12'),
  ('340', '9aadc2', '2020-03-15'),
  ('2', '3a9029', '2020-02-16'),
  ('75', 'f9a579', '2020-02-26'),
  ('128', '3ebe9b', '2020-03-19'),
  ('410', '4febb7', '2020-04-24'),
  ('152', '17b25b', '2020-04-24'),
  ('355', '8c6d48', '2020-02-10'),
  ('38', '213cf6', '2020-02-05'),
  ('217', '4c9d72', '2020-03-12'),
  ('182', '3b5797', '2020-02-08'),
  ('110', 'ffebf1', '2020-03-25'),
  ('145', '44fcb0', '2020-03-24'),
  ('228', 'ad1db4', '2020-02-24'),
  ('485', '7e5595', '2020-04-07'),
  ('294', 'dc62d6', '2020-03-05'),
  ('304', 'ba9a58', '2020-02-19'),
  ('52', 'd50c17', '2020-02-28'),
  ('438', '866d49', '2020-02-25'),
  ('382', 'b9a0f7', '2020-02-21'),
  ('378', '85e66c', '2020-03-08'),
  ('405', 'f4eabe', '2020-02-02'),
  ('170', '597f2d', '2020-04-23'),
  ('192', '3e9229', '2020-03-24'),
  ('276', '260448', '2020-04-15'),
  ('101', '85a869', '2020-04-28'),
  ('473', '2627f7', '2020-03-24'),
  ('69', '0cefde', '2020-02-16'),
  ('320', 'f1d981', '2020-04-02'),
  ('375', '23ca32', '2020-02-16'),
  ('115', '800a20', '2020-03-25'),
  ('415', '535cc0', '2020-03-04'),
  ('97', '812e1b', '2020-02-14'),
  ('108', 'd7d12e', '2020-02-22'),
  ('59', '52c8ed', '2020-02-09'),
  ('44', 'f757dc', '2020-02-22'),
  ('279', '47c697', '2020-04-20'),
  ('214', '5e526c', '2020-03-11'),
  ('9', 'aa4314', '2020-03-15'),
  ('457', 'bbdac6', '2020-03-07'),
  ('85', 'c8d024', '2020-02-26'),
  ('281', 'a05109', '2020-02-28'),
  ('302', 'ca844e', '2020-02-28'),
  ('30', '39b405', '2020-02-16'),
  ('288', 'e35f23', '2020-01-27'),
  ('21', 'a16550', '2020-03-18'),
  ('3', 'c69b7b', '2020-04-29'),
  ('165', 'ce3d64', '2020-04-01'),
  ('56', '54e5cc', '2020-05-03'),
  ('151', 'c0c44e', '2020-02-22'),
  ('296', 'ecfc8f', '2020-03-18'),
  ('74', '643cca', '2020-02-27'),
  ('34', '57e5d6', '2020-05-04'),
  ('418', 'c3f9df', '2020-02-13'),
  ('245', '6f9d5d', '2020-01-30'),
  ('67', '4a95e1', '2020-04-14'),
  ('325', '6ba042', '2020-02-21'),
  ('90', 'f855d1', '2020-03-09'),
  ('443', '9b63ef', '2020-03-07'),
  ('387', 'cd5e23', '2020-03-09'),
  ('334', '83c90d', '2020-02-02'),
  ('144', '978360', '2020-03-06'),
  ('39', 'b42dea', '2020-02-29'),
  ('393', '73b2a6', '2020-04-27'),
  ('287', '79bea2', '2020-02-20'),
  ('464', 'd5d96d', '2020-02-17'),
  ('312', 'bd7e5e', '2020-02-14'),
  ('167', '4351a6', '2020-02-24'),
  ('498', 'ada34c', '2020-02-06'),
  ('494', '4c0e26', '2020-03-18'),
  ('300', 'cb41cf', '2020-04-12'),
  ('118', '110cfc', '2020-02-12'),
  ('194', 'f78dc6', '2020-03-23'),
  ('374', 'aee327', '2020-03-23'),
  ('41', 'b98d87', '2020-03-11'),
  ('439', '6c8311', '2020-04-11'),
  ('206', '8dfcc4', '2020-02-05'),
  ('53', '540486', '2020-03-01'),
  ('32', 'ba790a', '2020-02-19'),
  ('318', '2e1e29', '2020-03-10'),
  ('275', '66efeb', '2020-03-09'),
  ('247', '3a8d9f', '2020-03-30'),
  ('260', '3d83d3', '2020-03-02'),
  ('423', 'efbd1e', '2020-04-10'),
  ('139', 'c1157e', '2020-03-15'),
  ('12', '648115', '2020-04-27'),
  ('479', '664816', '2020-04-16'),
  ('411', 'f488f9', '2020-02-27'),
  ('425', '952e3d', '2020-03-28'),
  ('495', 'eef00f', '2020-03-05'),
  ('234', '64114d', '2020-04-25'),
  ('316', '8c2ea6', '2020-02-05'),
  ('403', '9ab09e', '2020-02-03'),
  ('33', '16c732', '2020-03-28'),
  ('422', 'bf6d28', '2020-03-22'),
  ('264', '3cfd39', '2020-03-08'),
  ('185', '7a215b', '2020-02-20'),
  ('380', '45ba1f', '2020-03-02'),
  ('215', '827828', '2020-02-05'),
  ('270', '097ef0', '2020-03-01'),
  ('23', '36e2d2', '2020-02-14'),
  ('486', '12d9ac', '2020-03-26'),
  ('351', 'c812a8', '2020-03-02'),
  ('116', '9072b5', '2020-03-17'),
  ('314', '3b46d1', '2020-02-24'),
  ('386', '5ec8bc', '2020-03-06'),
  ('431', 'ef973c', '2020-02-22'),
  ('426', '9a881a', '2020-03-14'),
  ('433', '8e3c60', '2020-03-12'),
  ('462', 'db1906', '2020-03-26'),
  ('345', '1d81a0', '2020-01-25'),
  ('436', '6baaac', '2020-02-19'),
  ('180', '27beba', '2020-03-10'),
  ('263', '0f5c54', '2020-04-21'),
  ('197', '44b73b', '2020-02-18'),
  ('135', 'd4cbe4', '2020-03-01'),
  ('470', '705e88', '2020-03-01'),
  ('454', '341eee', '2020-03-15'),
  ('227', '2b18cf', '2020-02-14'),
  ('478', '818387', '2020-03-24'),
  ('73', '528446', '2020-02-19'),
  ('103', '71261c', '2020-02-20'),
  ('121', 'c5f4d3', '2020-01-30'),
  ('420', '78869c', '2020-03-17'),
  ('188', '6575e1', '2020-04-09'),
  ('291', '58c5ce', '2020-03-21'),
  ('48', '50fbda', '2020-04-09'),
  ('298', 'c2b6fb', '2020-02-13'),
  ('81', 'a6c3e9', '2020-04-20'),
  ('61', '31ef81', '2020-03-05'),
  ('244', '12010e', '2020-03-13'),
  ('251', '27ca09', '2020-03-27'),
  ('204', 'eb28c1', '2020-03-12'),
  ('171', 'ad0e0b', '2020-01-30'),
  ('456', '2ca105', '2020-02-21'),
  ('397', 'ccafa4', '2020-03-28'),
  ('179', 'c6af6f', '2020-04-12'),
  ('297', '6699f5', '2020-03-27'),
  ('321', '11fb62', '2020-03-23'),
  ('303', '29ba4a', '2020-02-20'),
  ('472', 'b9b37b', '2020-04-15'),
  ('444', '7f2a9f', '2020-02-10'),
  ('93', '5fb432', '2020-02-07'),
  ('252', '627b73', '2020-02-21'),
  ('31', 'f381a3', '2020-04-06'),
  ('253', '41f96b', '2020-03-30'),
  ('497', '7ed3c4', '2020-03-17'),
  ('109', '1c1827', '2020-03-08'),
  ('155', '29ed17', '2020-02-07'),
  ('133', '081823', '2020-03-02'),
  ('416', 'eb6dce', '2020-04-10'),
  ('199', '30cf50', '2020-03-18'),
  ('369', '3e976d', '2020-03-18'),
  ('383', 'ffe4fa', '2020-03-11'),
  ('230', '045eae', '2020-01-24'),
  ('7', '3db901', '2020-04-10'),
  ('78', '02ab48', '2020-02-10'),
  ('432', 'bf9484', '2020-02-24'),
  ('20', '1fef92', '2020-03-07'),
  ('1', '14de71', '2020-03-25'),
  ('106', '9d952a', '2020-03-30'),
  ('346', 'a83fe6', '2020-01-19'),
  ('71', 'dc259d', '2020-02-12'),
  ('448', '1893d2', '2020-03-21'),
  ('146', '2bae8b', '2020-01-16'),
  ('80', 'faf340', '2020-03-02'),
  ('396', '72483e', '2020-03-31'),
  ('162', '019287', '2020-02-26'),
  ('132', '203332', '2020-03-03'),
  ('322', 'aab11a', '2020-05-03'),
  ('389', 'eb2e77', '2020-01-11'),
  ('330', 'bc0725', '2020-02-01'),
  ('237', '5df013', '2020-03-21'),
  ('451', '775d62', '2020-02-19'),
  ('262', '70d128', '2020-02-03'),
  ('323', '90ea04', '2020-02-18'),
  ('348', 'b4ca8e', '2020-04-13'),
  ('337', '37d83e', '2020-03-27'),
  ('114', '80c7fe', '2020-03-03'),
  ('399', '6fa64e', '2020-02-20'),
  ('112', '8fcbe4', '2020-02-15'),
  ('65', 'c41c99', '2020-02-19'),
  ('124', '755606', '2020-01-17'),
  ('98', '64a2cd', '2020-03-11'),
  ('480', '43ab26', '2020-03-18'),
  ('26', 'ada1f4', '2020-03-04'),
  ('72', '981210', '2020-02-11'),
  ('232', 'd653c0', '2020-02-12'),
  ('28', '25ffae', '2020-04-03'),
  ('353', 'b482a7', '2020-03-19'),
  ('489', 'c72047', '2020-02-20'),
  ('225', 'af9a20', '2020-03-21'),
  ('83', 'c3fe7f', '2020-03-05'),
  ('395', '84a76b', '2020-03-07'),
  ('216', '2ecd95', '2020-03-02'),
  ('45', '5e7177', '2020-04-03'),
  ('295', '1fd98f', '2020-04-08'),
  ('213', 'e24f82', '2020-02-14'),
  ('274', '98fea4', '2020-03-18'),
  ('223', '534f9b', '2020-04-09'),
  ('352', '29c7fc', '2020-01-26'),
  ('362', '97e9e9', '2020-02-22'),
  ('221', '8bdb06', '2020-04-25'),
  ('430', 'c92a6e', '2020-03-12'),
  ('158', 'd1769c', '2020-02-15'),
  ('111', 'c70dec', '2020-04-09'),
  ('459', 'b5f8df', '2020-03-13'),
  ('16', '2a9154', '2020-01-25'),
  ('207', '217325', '2020-02-19'),
  ('62', '181819', '2020-02-29'),
  ('123', 'c4341f', '2020-03-21'),
  ('326', '78afce', '2020-03-02'),
  ('385', 'b442d8', '2020-03-04'),
  ('492', '158f74', '2020-03-07'),
  ('157', 'e24ca5', '2020-04-11'),
  ('308', '0f0071', '2020-02-24'),
  ('313', 'caf566', '2020-04-01'),
  ('208', '4d952d', '2020-03-16'),
  ('392', '4b1b90', '2020-02-06'),
  ('429', '6a610b', '2020-02-17'),
  ('25', '82bc98', '2020-03-29'),
  ('141', '3a4b22', '2020-03-26'),
  ('94', '71e764', '2020-03-20'),
  ('218', '501162', '2020-02-14'),
  ('434', '2a532c', '2020-02-23'),
  ('211', 'dee29e', '2020-02-15'),
  ('465', 'e972ab', '2020-02-09'),
  ('449', '7a53d4', '2020-02-14'),
  ('87', '7de4e2', '2020-01-22'),
  ('273', '06fafc', '2020-02-01'),
  ('51', 'e06515', '2020-01-23'),
  ('272', '300cc4', '2020-02-17'),
  ('70', '0fb544', '2020-01-29'),
  ('190', '7861c2', '2020-02-19'),
  ('350', 'bc7f8c', '2020-03-23'),
  ('424', 'c62387', '2020-02-12'),
  ('406', '26d52f', '2020-02-29'),
  ('176', 'bfd1bf', '2020-01-28'),
  ('22', 'd47de2', '2020-03-19'),
  ('156', '6f0f86', '2020-03-20'),
  ('390', '97cf1d', '2020-04-18'),
  ('173', '7bfc53', '2020-02-21'),
  ('261', '9f3a01', '2020-05-11'),
  ('42', 'cb11e2', '2020-04-21'),
  ('189', '8f11c3', '2020-04-01'),
  ('161', '182fc4', '2020-03-16'),
  ('117', '5d0d25', '2020-02-24'),
  ('40', '737d37', '2020-02-21'),
  ('43', '730b0a', '2020-04-08'),
  ('120', 'cc15a8', '2020-04-06'),
  ('440', 'b6aeb3', '2020-04-16'),
  ('19', '10e60b', '2020-03-27'),
  ('160', '0654dd', '2020-03-09'),
  ('357', 'd1381a', '2020-04-23'),
  ('242', 'c062a6', '2020-03-03'),
  ('331', 'd7ab2d', '2020-03-12'),
  ('266', 'ff589e', '2020-04-15'),
  ('315', '21c1f3', '2020-02-09'),
  ('307', '2895d2', '2020-04-11'),
  ('91', '725803', '2020-02-24'),
  ('29', 'e2fea1', '2020-02-22'),
  ('181', '2d04f6', '2020-02-29'),
  ('10', 'a5eabc', '2020-02-21'),
  ('35', 'bd3e41', '2020-03-22'),
  ('107', '5725df', '2020-03-22'),
  ('446', 'cf0e35', '2020-03-03'),
  ('86', '0b2c22', '2020-04-17'),
  ('400', 'bf07c1', '2020-03-20'),
  ('219', 'f4c5d6', '2020-03-21'),
  ('175', '19450a', '2020-05-05'),
  ('363', '13b038', '2020-03-12'),
  ('50', '718f49', '2020-03-15'),
  ('231', '569a46', '2020-03-19'),
  ('66', 'f0259d', '2020-03-25'),
  ('340', 'a5391b', '2020-03-17'),
  ('356', 'd0b56a', '2020-02-03'),
  ('391', '4d02a1', '2020-01-21'),
  ('487', '5667ad', '2020-02-02'),
  ('368', '3b5a90', '2020-02-21'),
  ('128', 'bac1e1', '2020-03-30'),
  ('355', 'f28438', '2020-03-06'),
  ('222', '3eb392', '2020-03-09'),
  ('38', '6df816', '2020-02-28'),
  ('164', '1e72dc', '2020-02-22'),
  ('217', '642b76', '2020-04-01'),
  ('177', '007c20', '2020-04-07'),
  ('182', '879617', '2020-02-22'),
  ('110', '53f242', '2020-04-07'),
  ('145', '0be779', '2020-04-18'),
  ('58', '70804f', '2020-02-22'),
  ('228', 'b0240a', '2020-03-18'),
  ('481', '1312a7', '2020-03-07'),
  ('52', '886f15', '2020-03-01'),
  ('258', '79dcb4', '2020-04-02'),
  ('378', 'b2d0ec', '2020-04-03'),
  ('483', 'ec9947', '2020-02-03'),
  ('450', 'ba275f', '2020-02-26'),
  ('405', '26e8e9', '2020-02-02'),
  ('84', '08494b', '2020-04-28'),
  ('170', '0e2865', '2020-05-09'),
  ('192', '9a0dce', '2020-03-25'),
  ('101', '97b3d3', '2020-05-17'),
  ('379', 'f1a3d4', '2020-02-15'),
  ('115', 'd7df7b', '2020-04-14'),
  ('415', '0ff4aa', '2020-03-17'),
  ('97', 'c2ad4f', '2020-02-15'),
  ('59', '64b8ea', '2020-02-22'),
  ('127', 'fb9e49', '2020-03-15'),
  ('329', 'ab0696', '2020-03-26'),
  ('44', 'f719c0', '2020-02-22'),
  ('11', '0af642', '2020-02-23'),
  ('401', '2bc5b5', '2020-01-28'),
  ('153', '8ff55a', '2020-03-06'),
  ('214', '8c3236', '2020-03-16'),
  ('9', '921931', '2020-03-26'),
  ('85', '90090d', '2020-03-02'),
  ('281', '355624', '2020-03-19'),
  ('95', '1a3c5e', '2020-02-20'),
  ('259', '9f76ef', '2020-01-31'),
  ('302', '4a2e0b', '2020-03-12'),
  ('409', '94584e', '2020-04-23'),
  ('30', '9c5130', '2020-02-28'),
  ('288', 'dc65c5', '2020-02-13'),
  ('3', '707486', '2020-05-28'),
  ('324', 'ef10ed', '2020-02-28'),
  ('398', '1b8abf', '2020-03-07'),
  ('56', '48f6a4', '2020-05-16'),
  ('151', 'ad1977', '2020-03-05'),
  ('209', '421e91', '2020-03-18'),
  ('74', '631d53', '2020-03-21'),
  ('138', 'bc602e', '2020-01-28'),
  ('245', '3fafa4', '2020-02-22'),
  ('205', 'cbd612', '2020-02-03'),
  ('325', 'aa36be', '2020-03-05'),
  ('484', '057b67', '2020-02-21'),
  ('144', 'ed7524', '2020-03-12'),
  ('39', '69a6d0', '2020-03-21'),
  ('471', '82aae1', '2020-02-23'),
  ('393', 'ea7f11', '2020-05-08'),
  ('287', '63bd64', '2020-03-08'),
  ('277', '5ba3b2', '2020-02-21'),
  ('290', '67ea46', '2020-03-12'),
  ('469', 'cb82d4', '2020-03-24'),
  ('300', 'b6e0ba', '2020-05-03'),
  ('284', '7710dc', '2020-04-23'),
  ('342', '7c91a0', '2020-03-24'),
  ('126', '916c47', '2020-02-08'),
  ('99', '6db4d5', '2020-04-21'),
  ('41', '72b2a9', '2020-03-26'),
  ('46', 'cf0e6f', '2020-02-17'),
  ('224', 'e2ee43', '2020-03-02'),
  ('53', 'edc731', '2020-03-20'),
  ('336', 'eb9e2a', '2020-03-27'),
  ('318', 'f99055', '2020-04-03'),
  ('247', '659633', '2020-04-26'),
  ('423', '638bde', '2020-04-28'),
  ('442', 'c22f50', '2020-02-01'),
  ('139', 'c0156f', '2020-04-10'),
  ('479', '3dcc14', '2020-05-07'),
  ('293', '128e68', '2020-01-10'),
  ('495', 'bbb0d5', '2020-03-08'),
  ('154', 'e30293', '2020-03-23'),
  ('316', '6fd08e', '2020-02-13'),
  ('256', '7501b6', '2020-02-29'),
  ('422', '7fb802', '2020-04-17'),
  ('264', '604874', '2020-03-29'),
  ('185', '28ff2a', '2020-03-11'),
  ('380', '288386', '2020-03-12'),
  ('215', '81e6ff', '2020-02-22'),
  ('130', '6208a6', '2020-02-29'),
  ('270', '0a0d20', '2020-03-22'),
  ('486', '07df0a', '2020-04-16'),
  ('435', '48c3fb', '2020-02-26'),
  ('384', '6ddca4', '2020-02-21'),
  ('351', '1c0d4d', '2020-03-03'),
  ('386', '54b87d', '2020-03-26'),
  ('433', 'f701c9', '2020-03-22'),
  ('180', '427eb3', '2020-03-29'),
  ('437', 'ed485a', '2020-03-19'),
  ('197', 'cd8f17', '2020-02-28'),
  ('470', '19c358', '2020-03-05'),
  ('482', 'e3ab4c', '2020-01-22'),
  ('227', '23ffc1', '2020-02-14'),
  ('500', 'f1ab70', '2020-02-28'),
  ('73', '9267e4', '2020-03-17'),
  ('103', '0cf906', '2020-02-26'),
  ('239', 'b0c26c', '2020-02-04'),
  ('121', '33d283', '2020-02-07'),
  ('420', '02a520', '2020-03-17'),
  ('188', '7de6a5', '2020-05-08'),
  ('240', 'de4b1d', '2020-03-11'),
  ('328', 'f3cbc4', '2020-02-17'),
  ('226', 'eca7a0', '2020-03-09'),
  ('210', '2905d8', '2020-04-24'),
  ('447', 'c43313', '2020-03-31'),
  ('61', 'd800b0', '2020-03-19'),
  ('468', 'e38549', '2020-03-21'),
  ('204', '6f6383', '2020-03-25'),
  ('456', 'fc9433', '2020-03-03'),
  ('397', '3759ff', '2020-03-30'),
  ('427', '958364', '2020-03-15'),
  ('297', '1946d7', '2020-04-03'),
  ('361', '081c65', '2020-03-09'),
  ('402', 'c4ef3d', '2020-02-25'),
  ('472', 'bf52f1', '2020-05-02'),
  ('445', 'ed8bf0', '2020-03-10'),
  ('93', '0946e5', '2020-02-17'),
  ('89', 'c593da', '2020-01-24'),
  ('373', '8cca90', '2020-02-11'),
  ('343', 'e40be6', '2020-03-09'),
  ('31', '0065c3', '2020-04-11'),
  ('327', '18d9ce', '2020-03-02'),
  ('14', 'e33921', '2020-03-11'),
  ('497', '969ff2', '2020-04-10'),
  ('155', '73c7ab', '2020-02-17'),
  ('416', '2c14b8', '2020-05-06'),
  ('195', 'c81772', '2020-02-04'),
  ('199', 'f7dc81', '2020-04-03'),
  ('369', '1af3ae', '2020-04-10'),
  ('441', 'adcc76', '2020-04-20'),
  ('7', 'e054d7', '2020-04-13'),
  ('78', '9067d0', '2020-03-09'),
  ('159', '264f86', '2020-02-09'),
  ('319', '54553e', '2020-03-07'),
  ('106', 'e66dd5', '2020-04-05'),
  ('203', 'd1182f', '2020-04-18'),
  ('8', 'a147a0', '2020-04-11'),
  ('370', 'd0b642', '2020-03-26'),
  ('71', '05cd91', '2020-03-09'),
  ('267', 'a377fa', '2020-03-06'),
  ('68', 'c2f826', '2020-03-08'),
  ('448', 'd6996b', '2020-03-31'),
  ('80', '1d5e5d', '2020-03-15'),
  ('396', 'b7bac0', '2020-04-15'),
  ('322', 'ba5cd6', '2020-05-03'),
  ('330', '2bfab9', '2020-02-21'),
  ('237', '277b97', '2020-04-02'),
  ('262', '6ec319', '2020-02-14'),
  ('323', '539a7c', '2020-03-06'),
  ('348', '33660d', '2020-04-14'),
  ('337', '7a63f8', '2020-04-04'),
  ('60', 'b6d776', '2020-03-01'),
  ('124', 'd194c5', '2020-01-17'),
  ('98', '62ad27', '2020-03-17'),
  ('200', 'cf1a69', '2020-02-15'),
  ('490', '34cc8e', '2020-02-13'),
  ('82', 'fe69b4', '2020-02-09'),
  ('306', '2dc589', '2020-04-06'),
  ('376', '6391f4', '2020-02-16'),
  ('202', '8f0f31', '2020-04-01'),
  ('358', '88868f', '2020-04-06'),
  ('26', '68756b', '2020-03-05'),
  ('198', 'c37668', '2020-01-30'),
  ('212', '423f8d', '2020-01-12'),
  ('37', 'eecf24', '2020-03-23'),
  ('28', 'd56286', '2020-04-23'),
  ('353', '72b87a', '2020-04-13'),
  ('489', '411419', '2020-03-17'),
  ('83', '30f0db', '2020-03-08'),
  ('395', '525c96', '2020-03-28'),
  ('213', '1b7706', '2020-03-07'),
  ('134', 'e1e012', '2020-03-12'),
  ('274', '0025a4', '2020-04-03'),
  ('36', '93e554', '2020-03-05'),
  ('430', '750a79', '2020-03-21'),
  ('102', '1ef2ec', '2020-03-05'),
  ('158', '81f5e0', '2020-03-04'),
  ('460', 'b5fe43', '2020-03-11'),
  ('111', 'b60fcf', '2020-05-04'),
  ('459', 'cdb72c', '2020-04-11'),
  ('207', '603b54', '2020-03-01'),
  ('123', 'b9937e', '2020-04-15'),
  ('385', '704a55', '2020-03-14'),
  ('492', '5d8f47', '2020-03-26'),
  ('365', '6f4e34', '2020-02-03'),
  ('313', '0ddc8e', '2020-04-15'),
  ('140', 'c9bfa9', '2020-03-14'),
  ('421', 'c686c1', '2020-01-29'),
  ('248', '42ca74', '2020-03-12'),
  ('208', '56f28f', '2020-04-10'),
  ('392', '863bdd', '2020-02-15'),
  ('24', 'f4b5e8', '2020-02-10'),
  ('191', 'e83169', '2020-03-21'),
  ('429', '8313df', '2020-03-06'),
  ('25', '46dd2f', '2020-03-29'),
  ('94', '59511b', '2020-03-22'),
  ('49', 'd345a8', '2020-02-23'),
  ('211', 'a26e03', '2020-02-20'),
  ('64', '87a4ba', '2020-03-18');

CREATE TABLE clique_bait.dbo.events (
  "visit_id" VARCHAR(6),
  "cookie_id" VARCHAR(6),
  "page_id" INTEGER,
  "event_type" INTEGER,
  "sequence_number" INTEGER,
  "event_time" datetime2
);

select * from clique_bait.dbo.campaign_identifier
select * from clique_bait.dbo.event_identifier
select * from clique_bait.dbo.events
select * from clique_bait.dbo.page_hierarchy
select * from clique_bait.dbo.users



-------2. Digital Analysis-----
--1.How many users are there?

select count(distinct(user_id)) as Total_users from clique_bait.dbo.users

---2.How many cookies does each user have on average?
with cte as (
select user_id , count(cookie_id) as Total_Cookies from clique_bait.dbo.users group by user_id)

select round(avg(Total_Cookies),2) as Avg_user   from cte


--3.What is the unique number of visits by all users per month?

select DATEPART(month,start_date) as Months , count (distinct e.visit_id) as Total_visits from clique_bait.dbo.users as u inner join clique_bait.dbo.events as e 
on e.cookie_id = u.cookie_id group by DATEPART(month,start_date) order by Months



--4.What is the number of events for each event type?


select  i.event_type, i.event_name , count ( ( e.event_type)) as Total from clique_bait.dbo.event_identifier as i inner join
clique_bait.dbo.events as e on i.event_type = e.event_type group by i.event_type, i.event_name order by i.event_type


---5.What is the percentage of visits which have a purchase event?

SELECT
  ROUND(
    100 * SUM(
      CASE
        WHEN t2.event_name = 'Purchase' THEN 1
        ELSE 0
      END
    ) / COUNT(DISTINCT visit_id),
    2
  ) AS percentage
FROM
  clique_bait.dbo.events t1
  INNER JOIN clique_bait.dbo.event_identifier t2 ON t1.event_type = t2.event_type


  ---6.What is the percentage of visits which view the checkout page but do not have a purchase event?
  select * from clique_bait.dbo.event_identifier
  select * from clique_bait.dbo.page_hierarchy